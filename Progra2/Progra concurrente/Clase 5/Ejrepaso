programa ej4clase3
areas
  areaC : AreaC(1,1,100,100)
robots
  robot tipo1
  variables
    CF: numero
    empezarav: numero
    TotalF: numero
    quiensoy: numero
    ganador1: numero
    ganador2: numero
  comenzar
    RecibirMensaje(quiensoy,robotjefe)
    EnviarMensaje(quiensoy, robotjefe)
    RecibirMensaje(empezarav,robotjefe)
    Pos(empezarav,1)
    TotalF:=0
    repetir 99
      mientras HayFlorEnLaEsquina
        tomarFlor
        TotalF:=TotalF+1
      mover
    mientras HayFlorEnLaEsquina
      tomarFlor
      TotalF:=TotalF+1
    EnviarMensaje(quiensoy,robotjefe)
    EnviarMensaje(TotalF,robotjefe)
    RecibirMensaje(ganador1,robotjefe)
    RecibirMensaje(ganador2,robotjefe)
    si (quiensoy=ganador1)
      Pos(50,1)
      repetir 48
        mover
      BloquearEsquina(50,50)
      mover
      mover
      LiberarEsquina(50,50)
      repetir 49
        mover
      EnviarMensaje(quiensoy,robotjefe)
    si (quiensoy=ganador2)
      Pos(1,50)
      derecha
      repetir 48
        mover
      BloquearEsquina(50,50)
      mover
      mover
      LiberarEsquina(50,50)
      repetir 49
        mover
      EnviarMensaje(quiensoy,robotjefe)
  fin
  robot tipo2
  variables
    floresjuntadas: numero
    flores:numero
    quiensos:numero
    max1:numero
    juega1:numero
    max2:numero
    juega2:numero
    termino1:boolean
    termino2:boolean
    SuperCampeon:numero
    avenida:numero
  comenzar
    max1:=0
    max2:=0
    floresjuntadas:=0
    EnviarMensaje(1,robot1)
    EnviarMensaje(2,robot2)
    EnviarMensaje(3,robot3)
    EnviarMensaje(4,robot4)
    avenida:=97
    repetir 4
      RecibirMensaje(quiensos,*)
      si (quiensos=1)      
        EnviarMensaje(avenida, robot1)
      sino
        si (quiensos=2)
          EnviarMensaje(avenida, robot2)
        sino
          si (quiensos=3) 
            EnviarMensaje(avenida, robot3) 
          sino
            si (quiensos=4)
              EnviarMensaje(avenida, robot4)
      avenida:=avenida+1
    repetir 4
      RecibirMensaje(quiensos,*)
      si (quiensos=1)
        RecibirMensaje(flores,robot1)
      sino
        si (quiensos=2)
          RecibirMensaje(flores,robot2)
        sino
          si (quiensos=3)  
            RecibirMensaje(flores,robot3)
          sino
            si (quiensos=4)
              RecibirMensaje(flores,robot4)
      si (max1<=flores)
        max2:=max1
        max1:=flores
        juega2:=juega1
        juega1:=quiensos
      sino
        si (max2<=flores)
          max2:=flores
          juega2:=quiensos
      floresjuntadas:=floresjuntadas+flores
    Informar(floresjuntadas)
    EnviarMensaje(juega1,robot1)
    EnviarMensaje(juega1,robot2)
    EnviarMensaje(juega1,robot3)
    EnviarMensaje(juega1,robot4)
    EnviarMensaje(juega2,robot1)
    EnviarMensaje(juega2,robot2)
    EnviarMensaje(juega2,robot3)
    EnviarMensaje(juega2,robot4)
    RecibirMensaje(quiensos,*)
    Informar(quiensos)
    RecibirMensaje(quiensos,*)
    Informar(quiensos)
  fin
variables
  robot1: tipo1
  robot2: tipo1
  robot3: tipo1
  robot4: tipo1
  robotjefe: tipo2
comenzar
  AsignarArea(robotjefe, areaC)
  AsignarArea(robot1, areaC)
  AsignarArea(robot2, areaC)
  AsignarArea(robot3, areaC)
  AsignarArea(robot4, areaC)
  Iniciar(robotjefe, 1, 1)
  Iniciar(robot1, 1, 2)
  Iniciar(robot2, 1, 3)
  Iniciar(robot3, 1, 4)
  Iniciar(robot4, 1, 5)
fin 



