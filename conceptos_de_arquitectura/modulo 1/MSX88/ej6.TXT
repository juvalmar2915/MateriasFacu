PIC EQU 20H
EOI EQU 20H
PIO EQU 30H
N_F10 EQU 10

ORG 40
IP_F10 DW RUT_F10

ORG 1000H
CARAC DB ?

ORG 3000H
RUT_F10: CLI
PUSH BX
MOV BX, OFFSET CARAC
POLL: IN AL, PIO
AND AL, 1
JNZ POLL ; MIENTRAS EL BUSY SEA 1 VA A POLL
MOV AL, [BX]
OUT PIO+1, AL ; LE DIGO EL CARACTER A IMPRIMIR A PB (PUERTO DE DATOS)
IN AL, PIO
OR AL, 02H
OUT PIO, AL ; STROBE A 1
IN AL, PIO
AND AL, 0FDH
OUT PIO, AL ; STROBE A 0
INC BX
DEC CL
JNZ POLL
MOV AL, EOI
OUT EOI, AL ; PIC: REGISTRO EOI
POP BX
STI
IRET

ORG 2000H
CLI
MOV AL, 0FEH ; ENMASCARO TODO MENOS INT 0
OUT PIC+1, AL ; IMR
MOV AL, N_F10
OUT PIC+4, AL ; INT 0
STI
MOV AL, 0FDH
OUT PIO+2, AL ; CA CON BUSY ENTRADA Y STROBE SALIDA
MOV AL, 0
OUT PIO+3, AL ; CB=0 PB CON SALIDA
IN AL, PIO
AND AL, 0FDH
OUT PIO, AL ; FUERZA A STROBE A 0
MOV CL, 0
MOV BX, OFFSET CARAC
LOOP: INT 6
INC CL
INC BX
JMP LOOP
END
