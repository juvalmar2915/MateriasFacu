TIMER EQU 10H
PIC EQU 20H
EOI EQU 20H
N_CLK EQU 10

ORG 40
IP_CLK DW RUT_CLK

ORG 1000H 
MIN DB 30H ; REPRESENTA CONJUNTO DE MINUTOS (6 CONJUNTOS SON UNA HORA)
    DB 30H ; REPRESENTA MINUTOS
SEG DB 30H ; REPRESENTA UN CONJUNTO DE SEGUNDOS (6 CONJUNTOS SON UN MINUTO)
    DB 30H ; REPRESENTA LOS SEGUNDOS
FIN DB ?
   
ORG 3000H
RUT_CLK: PUSH AX
INC SEG ; AL COMPARADOR SER CADA 10 SEGUNDOS SOLO MUESTRO EN PANTALLA CADA 10 SEGUNDOS
CMP SEG, 36H ; PASO UN MINUTO
JNZ RESET
MOV SEG, 30H
INC MIN+1
CMP MIN+1, 3AH ; SI SE CUMPLE ESTO PASARON 10 MINUTOS
JNZ RESET
MOV MIN+1, 30H ; VUELVO A INICIALIZAR LOS MINUTOS
INC MIN
CMP MIN, 36H ; SI SE CUMPLE PASO UNA HORA
JNZ RESET
MOV MIN, 30H ; INICIALIZO LA HORA
RESET: INT 7
MOV AL, 0
OUT TIMER, AL
MOV AL, EOI
OUT PIC, AL
POP AX
IRET

ORG 2000H
CLI
MOV AL, 0FDH
OUT PIC+1, AL ; PIC: registro IMR
MOV AL, N_CLK
OUT PIC+5, AL ; PIC: registro INT1
MOV AL, 10 ; COMPARO CADA 10 SEGUNDOS
OUT TIMER+1, AL ; TIMER: registro COMP
MOV AL, 0
OUT TIMER, AL ; TIMER: registro CONT
MOV BX, OFFSET MIN ; COMIENZO A IMPRIMIR A PARTIR DE MINUTOS
MOV AL, OFFSET FIN-OFFSET MIN ; IMPRIMO DESDE MIN HASTA LOS SEGUNDOS
STI 
LAZO: JMP LAZO
END
