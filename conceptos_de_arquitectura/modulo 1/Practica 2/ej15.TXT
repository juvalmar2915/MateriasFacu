TIMER EQU 10H
PIC EQU 20H
EOI EQU 20H
N_F10 EQU 10
N_CLK EQU 11

ORG 40
IP_F10 DW RUT_F10
ORG 44
IP_CLK DW RUT_CLK

ORG 1000H
MSJ DB "INGRESE UN NUMERO:"
SEG DB ?

ORG 3000H
RUT_F10: CLI
PUSH AX
MOV AL, 0FDH ; ENMASCARO TODO MENOS INT 1(TIMER)
OUT PIC+1, AL
MOV AL, EOI ; FINALIZACION DE INTERRUPCION
OUT PIC, AL
POP AX 
STI
IRET

RUT_CLK: PUSH AX
DEC SEG
CMP SEG, 2FH ; COMPARO HASTA QUE IMPRIMA 0
JNZ RESET
INT 0
RESET: INT 7
MOV AL, 0
OUT TIMER, AL
MOV AL, EOI
OUT PIC, AL
POP AX
IRET

ORG 2000H
CLI
MOV AL, 0FEH ; LO UNICO QUE NO ENMASCARO ES INT 0
OUT PIC+1, AL ; IMR
MOV AL, N_F10
OUT PIC+4, AL ; INT0
MOV AL, N_CLK
OUT PIC+5, AL ; INT1
MOV AL, 1
OUT TIMER+1, AL ; COMP
MOV AL, 0
OUT TIMER, AL ; CONT
MOV BX, OFFSET MSJ
MOV AL, OFFSET SEG- OFFSET MSJ
INT 7
MOV BX, OFFSET SEG
INT 6
STI
LAZO: JMP LAZO
END
