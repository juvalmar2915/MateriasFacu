PIC EQU 20H
TIMER EQU 10H
PIO EQU 30H
N_CLK EQU 10

ORG 40
IP_CLK DW RUT_CLK

ORG 3000H
RUT_CLK: PUSH AX
MOV BL, 1 ; CUANDO LLAME A ROTARIZQ VA A ROTAR UNA VEZ
CMP DH, 15 ;SI PASARON 15 SEGS SIGNIFICA QUE COMPLETO AMBOS RECORRIDOS
JNZ NORESET
MOV DH, 0
NORESET: CMP DH, 8 ;COMPLETO UN RECORRIDO (PRENDIO LA LUZ 0 A LA 7)
JC HAGOIZQ
CALL ROTARDER
JMP LUCES
HAGOIZQ: CALL ROTARIZQ
LUCES: MOV AL, DL
OUT PIO+1, AL ;ENCIENDO LUZ
INC DH
MOV AL, 0
OUT TIMER, AL
MOV AL, EOI
OUT PIC, AL
POP AX
IRET

ORG 3500H
ROTARIZQ: ADD DL,DL
ADC DL, 0
DEC BL
JNZ ROTARIZQ
RET
ROTARDER: PUSH BX
MOV BL,7 ; ROTO DERECHA UNA VEZ
CALL ROTARIZQ
POP BX
RET

ORG 2000H
CLI
MOV AL, 0FDH ; ENMASCARO TODO MENOS INT 1
OUT PIC+1, AL ; IMR
MOV AL, N_CLK
OUT PIC+5, AL ; INT 1
MOV AL, 1
OUT TIMER+1, AL ; COMP
MOV AL, 0
OUT TIMER, AL ; CONT
OUT PIO+3, AL ; PB SALIDA
OUT PIO+1, AL
MOV DL, 80H ; LUZ 8VA
MOV DH, 0 ; SEGUNDOS QUE PASAN
STI
LAZO: JMP LAZO
END

